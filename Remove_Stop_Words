import os
import spacy

nlp = spacy.load("en_core_web_sm")


extraction_folder = "Extracting_Words"
output_folder = "Remove_Stop_Words"


os.makedirs(output_folder, exist_ok=True)



if not os.path.exists(extraction_folder):
    print(f"The directory '{extraction_folder}' does not exist.")
else:
   
    text_files = [f for f in os.listdir(extraction_folder) if f.endswith(".txt")]

    if not text_files:
        print(f"No text files found in '{extraction_folder}'.")
    else:
        for text_file in text_files:
          
            text_file_path = os.path.join(extraction_folder, text_file)
            with open(text_file_path, "r", encoding="utf-8") as file:
                text = file.read()

            
            doc = nlp(text)

            filtered_text = " ".join(token.text for token in doc if not token.is_stop)

           
            output_file_path = os.path.join(output_folder, text_file)
            with open(output_file_path, "w", encoding="utf-8") as file:
                file.write(filtered_text)

            print(f"Removed stop words from '{text_file}' and saved the result in '{output_folder}/{text_file}'")

         
            print(f"Filtered text from '{text_file}':")
            print(filtered_text)
            print("-" * 100)
